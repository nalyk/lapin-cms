/*!
 * bootstrap-modal-wrapper (http://javatmp.com)
 * Bootstrap modal wrapper plugin creates dynamic and nested stacked dialog instances
 *
 * @version 2.0.1
 * @link https://github.com/JavaTMP/bootstrap-modal-wrapper
 * @copyright 2018 JavaTMP
 * @license MIT
 */
!function(o,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery"),require("bootstrap")):"function"==typeof define&&define.amd?define("bootstrap-modal-wrapper-factory",["jquery","bootstrap"],function(o){return t(o)}):o.BootstrapModalWrapperFactory=t(o.jQuery)}(this,function(e){"use strict";var i={starterZIndex:1e4};function o(o){this.options=e.extend({},i,o),this.defaults=i,this.globalModals=[],this.registerGlobalEventsHandler()}o.prototype.createModal=function(o){var t=new l(this,o);return this.globalModals.push(t),t.init(),t},o.prototype.createAjaxModal=function(o){var a=e.extend(!0,{},{sendId:!0,idParameter:"ajaxModalId",updateSizeAfterDataFetchTo:"modal-lg",ajaxContainerReadyEventName:"ajax-container-ready",ajax:{type:"GET",dataType:"html",url:null,data:{},success:function(o,t,i){n.updateSize(a.updateSizeAfterDataFetchTo),n.updateMessage(o),setTimeout(function(){e("#"+n.options.id).trigger(a.ajaxContainerReadyEventName,[n])},0)}}},o),n=this.createModal(a);return n.options.sendId&&(n.options.ajax.data[n.options.idParameter]=n.options.id),n.originalModal.removeClass("fade"),n.originalModal.find(".modal-dialog").css({transition:"all .3s"}),n.originalModal.one("shown.bs.modal",function(o){e.ajax(n.options.ajax)}),n.show(),n};var a="<div class='modal-header'></div>",n="<button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>";var s=function(o){return o+"-"+Math.floor(1e8*Math.random()+1)+"-"+(new Date).getTime()+"-"+function(){var o,t,i="";for(o=0;o<32;o++)t=16*Math.random()|0,8!==o&&12!==o&&16!==o&&20!==o||(i+="-"),i+=(12===o?4:16===o?3&t|8:t).toString(16);return i}()};function l(o,t){this.factory=o,this.options=e.extend(!0,{},{id:s("b-m-w"),title:null,message:null,closable:!1,closeByBackdrop:!0,closeByKeyboard:!0,size:null,onDestroy:null,buttons:[],headerClass:null,localData:{},centered:!1,modalDialogScrollable:!0,modalTitleContainer:"<h5 class='modal-title'></h5>",modalButtonContainer:"<button id='' type='button' class='my-1'></button>",modalFooterContainer:"<div class='modal-footer d-flex flex-wrap'></div>"},t),this.originalModal=null,this.isDestroy=!1,this.isOpen=!1}return l.prototype.generateTemplate=function(){this.originalModal=e("<div class='modal fade' id='' tabindex='-1' role='dialog' aria-labelledby='' aria-hidden='true'><div class='modal-dialog' role='document'><div class='modal-content'></div></div></div>"),this.originalModal.attr("id",this.options.id);var o=this.originalModal.find(".modal-dialog");if(!this.options.size||"modal-sm"!==this.options.size&&"modal-lg"!==this.options.size&&"modal-xl"!==this.options.size||o.addClass(this.options.size),!0===this.options.centered&&o.addClass("modal-dialog-centered"),!0===this.options.modalDialogScrollable&&o.addClass("modal-dialog-scrollable"),(this.options.title||this.options.closable)&&this.originalModal.find(".modal-content").append(a),this.options.title&&this.originalModal.find(".modal-header").append(this.options.modalTitleContainer).find(".modal-title").append(this.options.title),this.options.closable&&this.originalModal.find(".modal-header").append(n),this.options.headerClass&&this.originalModal.find(".modal-header").addClass(this.options.headerClass),this.options.message&&(this.originalModal.find(".modal-content").append("<div class='modal-body'></div>"),this.originalModal.find(".modal-body").html("").append(this.options.message)),this.options.buttons&&0<this.options.buttons.length){this.originalModal.find(".modal-content").append(this.options.modalFooterContainer);for(var t=0;t<this.options.buttons.length;t++){var i=this.options.buttons[t];this.addButton(i,!1)}}},l.prototype.init=function(){this.generateTemplate();var i=this;this.originalModal.on("show.bs.modal",function(o){o.stopPropagation();var t=i.factory.defaults.starterZIndex+10*e(".modal.show").length;e(this).css("z-index",t),setTimeout(function(){e(".modal-backdrop").not(".modal-stack").first().css("z-index",t-1).addClass("modal-stack")},0)}).on("shown.bs.modal",function(o){i.isOpen=!0}).on("hide.bs.modal",function(o){i.options.onDestroy&&"function"==typeof i.options.onDestroy&&(i.options.onDestroy.call(i,i)||o.preventDefault())}).on("hidden.bs.modal",function(o){o.stopPropagation(),i.destroy(),e(".modal.show").length&&e("body").addClass("modal-open")})},l.prototype.destroy=function(){var t=this;this.originalModal.modal("hide").promise().done(function(){t.isOpen=!1,e("#"+t.options.id).off("show.bs.modal"),e("#"+t.options.id).off("hidden.bs.modal"),e("#"+t.options.id).modal("dispose");for(var o=0;o<t.options.buttons.length;o++){t.options.buttons[o].buttonObject.off()}t.isDestroy=!0;for(o=t.factory.globalModals.length;o--;)if(t.factory.globalModals[o].options.id===t.options.id){t.factory.globalModals.splice(o,1);break}e("#"+t.options.id).find(".modal-dialog").off(),e("#"+t.options.id).off(),e("#"+t.options.id).remove()})},l.prototype.show=function(){var o={show:!0,backdrop:!!this.options.closeByBackdrop||"static",keyboard:this.options.closeByKeyboard,focus:!0};return this.originalModal.modal(o),this},l.prototype.hide=function(){this.originalModal.modal("hide")},l.prototype.updateTitle=function(o){this.options.title=o;var t=this.originalModal.find(".modal-title");if(0===t.length){var i=this.originalModal.find(".modal-header");0===i.length&&(this.originalModal.find(".modal-content").prepend(a),i=this.originalModal.find(".modal-header")),i.prepend(this.options.modalTitleContainer),t=this.originalModal.find(".modal-title")}return t.html(o),this.originalModal.modal("handleUpdate"),this},l.prototype.updateClosable=function(o){if(this.options.closable!==o){if(this.options.closable=o,!0===this.options.closable){var t=this.originalModal.find(".modal-header");0===t.length&&(this.originalModal.find(".modal-content").prepend(a),t=this.originalModal.find(".modal-header")),t.append(n)}else if(!1===this.options.closable){var i=this.originalModal.find(".modal-header").find("button.close");i.off(),i.remove(),0===this.originalModal.find(".modal-header").find(".modal-title").length&&this.originalModal.find(".modal-header").remove()}this.originalModal.modal("handleUpdate")}return this},l.prototype.updateClosableByBackdrop=function(o){return this.options.closeByBackdrop!==o&&(this.options.closeByBackdrop=o,e("#"+this.options.id).data("bs.modal")._config.backdrop=!!this.options.closeByBackdrop||"static",this.originalModal.modal("handleUpdate")),this},l.prototype.removeHeader=function(){var o=this.originalModal.find(".modal-header");if(0<o.length){var t=o.find("button.close");0<t.length&&(t.off(),t.remove(),this.options.closable=!1),o.remove(),this.options.title=null}return this.originalModal.modal("handleUpdate"),this},l.prototype.updateMessage=function(o){return this.options.message=o,this.originalModal.find(".modal-body").html("").html(o),this.originalModal.modal("handleUpdate"),this},l.prototype.updateSize=function(o){return this.options.size!==o&&(this.options.size=o,this.options.size&&void 0!==this.options.size&&null!==this.options.size?"modal-sm"!==this.options.size&&"modal-lg"!==this.options.size&&"modal-xl"!==this.options.size||(this.originalModal.find(".modal-dialog").removeClass("modal-xl modal-lg modal-sm"),this.originalModal.find(".modal-dialog").addClass(this.options.size)):this.originalModal.find(".modal-dialog").removeClass("modal-xl modal-lg modal-sm"),this.originalModal.modal("handleUpdate")),this},l.prototype.updateModalDialogScrollable=function(o){if(this.options.modalDialogScrollable!==o){this.options.modalDialogScrollable=o;var t=this.originalModal.find(".modal-dialog");!0===this.options.modalDialogScrollable?t.addClass("modal-dialog-scrollable"):!1===this.options.modalDialogScrollable&&t.removeClass("modal-dialog-scrollable"),this.originalModal.modal("handleUpdate")}return this},l.prototype.addButton=function(o,t){var i=this.originalModal.find(".modal-footer");0===i.length&&(this.originalModal.find(".modal-content").append(this.options.modalFooterContainer),i=this.originalModal.find(".modal-footer")),o.id=o.id?o.id:s("modal-button");var a=o.template?o.template:this.options.modalButtonContainer,n=e(a);return n.attr("id",o.id),n.addClass(o.cssClass?o.cssClass:""),n.append(o.label),(o.buttonObject=n).on("click",{modalWrapper:this,button:n,buttonData:o},function(o){var t=o.data.modalWrapper,i=o.data.button,a=o.data.buttonData;if(a.action&&"function"==typeof a.action)return a.action.call(t,i,a,o)}),!1!==t&&this.options.buttons.push(o),n.appendTo(i)},l.prototype.setOnDestroy=function(o){this.options.onDestroy=o},l.prototype.removeButton=function(o){for(var t=null,i=this.options.buttons.length;i--;){if(this.options.buttons[i].id===o)(t=this.options.buttons[i]).buttonObject.off(),t.buttonObject.remove(),this.options.buttons.splice(i,1)}return this},o.prototype.showMessage=function(o){var t=null;return t="object"==typeof o&&o.constructor==={}.constructor?e.extend(!0,i,o):e.extend(!0,i,{message:o}),this.createModal(t).show()},o.prototype.alert=function(o){var t={title:"Alert",message:"",closable:!0,closeByBackdrop:!0,closeByKeyboard:!0,buttons:[{label:"OK",cssClass:"btn btn-primary",action:function(o,t,i){this.hide()}}]},i=null;return i="object"==typeof o&&o.constructor==={}.constructor?e.extend(!0,t,o):e.extend(!0,t,{message:o}),this.createModal(i).show()},o.prototype.confirm=function(a){var o={title:"Confirm",message:"Are You Sure ?",closable:!1,closeByBackdrop:!1,closeByKeyboard:!1,buttons:[{label:"No",cssClass:"btn btn-secondary",action:function(o,t,i){this.hide(),a.onConfirmCancel&&"function"==typeof a.onConfirmCancel&&a.onConfirmCancel()}},{label:"Yes",cssClass:"btn btn-primary",action:function(o,t,i){this.hide(),a.onConfirmAccept&&"function"==typeof a.onConfirmAccept&&a.onConfirmAccept()}}]},t=e.extend({},o,a);return this.createModal(t).show()},o.prototype.registerGlobalEventsHandler=function(){var a=this;e(document).on("show.bs.modal",".modal",function(o){var t=a.options.starterZIndex+10*e(".modal.show").length;e(this).css("z-index",t),setTimeout(function(){e(".modal-backdrop").not(".modal-stack").first().css("z-index",t-1).addClass("modal-stack")},0)}).on("hidden.bs.modal",".modal",function(o){e(".modal.show").length&&e("body").addClass("modal-open")}).on("inserted.bs.tooltip",function(o){var t=a.options.starterZIndex+10*e(".modal.show").length,i=e(o.target).attr("aria-describedby");e("#"+i).css("z-index",t)}).on("inserted.bs.popover",function(o){var t=a.options.starterZIndex+10*e(".modal.show").length,i=e(o.target).attr("aria-describedby");e("#"+i).css("z-index",t)})},new o});